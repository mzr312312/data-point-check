Excel 表格合并工具

功能说明

这个 Python 脚本是一个图形界面工具，用于合并多个 Excel 文件的工作表数据。主要功能包括：

1. 合并多个 Excel 文件中的同名工作表
2. 自动处理不同文件间列名不一致的情况
3. 保留原始文件来源信息
4. 支持自定义列名所在行
5. 提供详细的合并日志记录
6. 显示合并进度

使用说明

运行环境要求

• Python 3.x

• 需要安装以下库：

  • pandas

  • numpy

  • openpyxl

  • tkinter (通常随 Python 一起安装)

可以通过以下命令安装所需库：

pip install pandas numpy openpyxl


使用方法

1. 运行程序后，将显示图形界面
2. 在"列名所在行"处设置 Excel 文件中列名所在的行号（默认为第1行）
3. 点击"选择Excel文件"按钮，选择要合并的 Excel 文件（支持多选）
4. 文件列表将显示在界面中
5. 点击"开始合并"按钮开始合并过程
6. 合并完成后，结果将保存在程序所在目录的"output"文件夹中
7. 合并过程中可以查看日志区域了解处理进度和状态

合并规则

• 同名工作表将被合并到同一个工作表中

• 如果不同文件中的同名工作表列名完全相同，直接合并

• 如果列名不完全相同，会创建一个包含所有列的工作表，缺失值填充为 NaN

• 每个合并后的工作表会添加"来源文件"列，记录数据来自哪个文件

输出文件

合并结果将保存为 Excel 文件，文件名格式为：合并表格_YYYYMMDD_HHMMSS.xlsx

注意事项

1. 确保选择的 Excel 文件没有被其他程序占用
2. 合并大型 Excel 文件可能需要较长时间
3. 如果工作表名称超过31个字符，会被截断（Excel限制）
4. 空工作表会被自动跳过

常见问题

Q: 合并后为什么有些列的值是空的？
A: 这是因为不同文件中的同名工作表列名不完全一致，对于某些文件中不存在的列，会自动填充为 NaN（空值）

Q: 如何知道合并后的数据来自哪个文件？
A: 合并后的每个工作表都包含"来源文件"列，记录了数据来自哪个原始文件

Q: 为什么合并后工作表名称被截断了？
A: Excel 限制工作表名称不能超过31个字符，超过部分会被自动截断